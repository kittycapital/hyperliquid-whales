<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Perp DEX Analytics</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&family=Noto+Sans+KR:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { background: #0f0f13; color: #e4e4e7; font-family: 'Noto Sans KR', sans-serif; min-height: 100vh; display: flex; }
        
        .sidebar { width: 220px; background: #16161d; border-right: 1px solid #2a2a35; padding: 20px 0; position: fixed; height: 100vh; z-index: 100; }
        .logo { display: flex; align-items: center; gap: 12px; padding: 0 20px; margin-bottom: 32px; }
        .logo-icon { width: 36px; height: 36px; background: linear-gradient(135deg, #22d3ee, #06b6d4); border-radius: 10px; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 14px; color: #000; }
        .logo-text { font-size: 1.1rem; font-weight: 600; color: #fff; }
        .logo-sub { font-size: 0.65rem; color: #22d3ee; display: block; }
        .nav-menu { list-style: none; }
        .nav-item { padding: 14px 20px; display: flex; align-items: center; gap: 12px; cursor: pointer; transition: all 0.2s; border-left: 3px solid transparent; color: #a1a1aa; font-size: 0.85rem; font-weight: 500; }
        .nav-item:hover { background: rgba(34, 211, 238, 0.08); color: #e4e4e7; }
        .nav-item.active { background: rgba(34, 211, 238, 0.15); border-left-color: #22d3ee; color: #22d3ee; }
        .nav-icon { width: 18px; height: 18px; }
        
        .main-content { flex: 1; margin-left: 220px; padding: 24px 32px; min-height: 100vh; }
        .status-badge { display: inline-flex; align-items: center; gap: 6px; background: rgba(34, 211, 238, 0.15); border: 1px solid rgba(34, 211, 238, 0.4); padding: 6px 14px; border-radius: 20px; font-size: 0.7rem; color: #22d3ee; margin-bottom: 20px; }
        .status-dot { width: 8px; height: 8px; background: #22d3ee; border-radius: 50%; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .page-header { margin-bottom: 24px; }
        .page-header h1 { font-size: 1.6rem; font-weight: 600; color: #fff; margin-bottom: 6px; }
        .page-header p { color: #8b8b9a; font-size: 0.85rem; }
        .section { display: none; }
        .section.active { display: block; }
        
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 14px; margin-bottom: 24px; }
        .stat-card { background: #16161d; border: 1px solid #2a2a35; border-radius: 12px; padding: 18px; }
        .stat-label { font-size: 0.7rem; color: #8b8b9a; text-transform: uppercase; letter-spacing: 0.05em; margin-bottom: 6px; }
        .stat-value { font-family: 'JetBrains Mono', monospace; font-size: 1.4rem; font-weight: 600; color: #22d3ee; }
        .card { background: #16161d; border: 1px solid #2a2a35; border-radius: 12px; padding: 20px; margin-bottom: 20px; }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; flex-wrap: wrap; gap: 10px; }
        .card-title { font-size: 0.95rem; font-weight: 600; color: #fff; }
        
        .tabs { display: flex; gap: 4px; background: #1e1e26; padding: 4px; border-radius: 8px; }
        .tab { padding: 6px 12px; border-radius: 6px; border: none; background: transparent; color: #8b8b9a; font-family: 'Noto Sans KR', sans-serif; font-size: 0.7rem; font-weight: 500; cursor: pointer; transition: all 0.2s; white-space: nowrap; }
        .tab:hover { color: #c1c1ca; }
        .tab.active { background: #22d3ee; color: #000; }
        .controls-row { display: flex; gap: 10px; flex-wrap: wrap; align-items: center; }
        select { appearance: none; background: #1e1e26 url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%238b8b9a' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E") no-repeat right 10px center; border: 1px solid #2a2a35; border-radius: 6px; padding: 8px 32px 8px 12px; color: #e4e4e7; font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; cursor: pointer; min-width: 140px; }
        select:focus { outline: none; border-color: #22d3ee; }
        
        /* DEX Tabs */
        .dex-tabs { display: flex; gap: 8px; margin-bottom: 20px; }
        .dex-tab { display: flex; align-items: center; gap: 8px; padding: 10px 18px; border-radius: 10px; border: 1px solid #2a2a35; background: #16161d; color: #8b8b9a; font-size: 0.85rem; font-weight: 500; cursor: pointer; transition: all 0.2s; }
        .dex-tab:hover { border-color: #3d3d4a; color: #c1c1ca; }
        .dex-tab.active { border-color: #22d3ee; background: rgba(34, 211, 238, 0.15); color: #22d3ee; }
        .dex-tab img { width: 20px; height: 20px; border-radius: 50%; }
        .dex-tab .dex-name { font-weight: 600; }
        
        .table-container { overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 0.8rem; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #2a2a35; }
        th { background: #1e1e26; color: #8b8b9a; font-weight: 500; text-transform: uppercase; font-size: 0.65rem; letter-spacing: 0.05em; position: sticky; top: 0; z-index: 10; }
        th.sortable { cursor: pointer; user-select: none; }
        th.sortable:hover { color: #22d3ee; }
        th.sort-active { color: #22d3ee; }
        td { font-family: 'JetBrains Mono', monospace; color: #b1b1ba; }
        tr:hover td { background: rgba(34, 211, 238, 0.05); }
        .positive { color: #4ade80 !important; }
        .negative { color: #f87171 !important; }
        .bullish { color: #4ade80 !important; }
        .bearish { color: #f87171 !important; }
        .coin-name { color: #fff; font-weight: 500; }
        .address { max-width: 150px; overflow: hidden; text-overflow: ellipsis; }
        .address a { color: #22d3ee; text-decoration: none; }
        .address a:hover { text-decoration: underline; }
        .direction { padding: 3px 8px; border-radius: 4px; font-size: 0.7rem; font-weight: 600; }
        .direction.long { background: rgba(74, 222, 128, 0.2); color: #4ade80; }
        .direction.short { background: rgba(248, 113, 113, 0.2); color: #f87171; }
        .rank { display: inline-flex; align-items: center; justify-content: center; min-width: 32px; padding: 2px 6px; background: #2a2a35; border-radius: 4px; font-size: 0.7rem; color: #8b8b9a; }
        .rank.top3 { background: linear-gradient(135deg, #fbbf24, #f59e0b); color: #000; font-weight: 600; }
        .loading { display: flex; align-items: center; justify-content: center; padding: 40px; color: #8b8b9a; gap: 10px; }
        .loading-spinner { width: 20px; height: 20px; border: 2px solid #2a2a35; border-top-color: #22d3ee; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .no-data { text-align: center; padding: 40px; color: #8b8b9a; }
        .last-updated { text-align: center; margin-top: 20px; font-size: 0.75rem; color: #6b6b7a; }
        
        .bar-chart { display: flex; flex-direction: column; gap: 6px; max-height: 400px; overflow-y: auto; padding-right: 10px; }
        .bar-row { display: flex; align-items: center; gap: 10px; font-size: 0.75rem; }
        .bar-label { width: 60px; text-align: right; color: #fff; font-weight: 500; font-family: 'JetBrains Mono', monospace; }
        .bar-container { flex: 1; display: flex; height: 24px; }
        .bar-negative { flex: 1; display: flex; justify-content: flex-end; }
        .bar-positive { flex: 1; display: flex; justify-content: flex-start; }
        .bar { height: 100%; border-radius: 3px; min-width: 2px; transition: width 0.3s; display: flex; align-items: center; padding: 0 6px; font-size: 0.65rem; font-family: 'JetBrains Mono', monospace; }
        .bar.short { background: linear-gradient(90deg, #f87171, #ef4444); color: #fff; justify-content: flex-end; }
        .bar.long { background: linear-gradient(90deg, #22c55e, #4ade80); color: #fff; }
        .bar-zero { width: 2px; background: #3d3d4a; }
        .chart-container { position: relative; }
        .chart-legend { display: flex; gap: 20px; margin-bottom: 10px; justify-content: center; }
        .legend-item { display: flex; align-items: center; gap: 6px; font-size: 0.75rem; color: #8b8b9a; }
        .legend-dot { width: 12px; height: 12px; border-radius: 3px; }
        .legend-dot.long { background: linear-gradient(90deg, #22c55e, #4ade80); }
        .legend-dot.short { background: linear-gradient(90deg, #f87171, #ef4444); }
        
        .sub-tabs { display: flex; gap: 8px; margin-bottom: 16px; }
        .sub-tab { padding: 10px 20px; border-radius: 8px; border: 1px solid #2a2a35; background: transparent; color: #8b8b9a; font-family: 'Noto Sans KR', sans-serif; font-size: 0.8rem; font-weight: 500; cursor: pointer; transition: all 0.2s; }
        .sub-tab:hover { border-color: #3d3d4a; color: #c1c1ca; }
        .sub-tab.active { border-color: #22d3ee; background: rgba(34, 211, 238, 0.15); color: #22d3ee; }
        
        .expand-btn { background: none; border: none; color: #8b8b9a; cursor: pointer; padding: 4px; border-radius: 4px; transition: all 0.2s; }
        .expand-btn:hover { background: #2a2a35; color: #22d3ee; }
        .expand-btn.expanded svg { transform: rotate(180deg); }
        .positions-row { display: none; }
        .positions-row.show { display: table-row; }
        .positions-content { background: #1e1e26; border-radius: 8px; padding: 12px; }
        .positions-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr)); gap: 10px; }
        .position-card { background: #16161d; border: 1px solid #2a2a35; border-radius: 8px; padding: 12px; cursor: pointer; transition: all 0.2s; }
        .position-card:hover { border-color: #22d3ee; transform: translateY(-2px); }
        .position-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .position-coin { font-weight: 600; color: #fff; font-size: 0.85rem; }
        .position-details { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; }
        .position-detail { display: flex; flex-direction: column; }
        .position-detail-label { font-size: 0.65rem; color: #6b6b7a; }
        .position-detail-value { font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: #b1b1ba; }
        .position-hint { font-size: 0.65rem; color: #6b6b7a; margin-top: 8px; text-align: center; border-top: 1px solid #2a2a35; padding-top: 8px; }
        
        .liq-header-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; flex-wrap: wrap; gap: 10px; }
        .liq-price-box { background: #1e1e26; border: 1px solid #2a2a35; border-radius: 8px; padding: 10px 16px; text-align: center; }
        .liq-price-label { font-size: 0.65rem; color: #8b8b9a; margin-bottom: 4px; }
        .liq-price-value { font-family: 'JetBrains Mono', monospace; font-size: 1.1rem; font-weight: 600; color: #22d3ee; }
        .liq-legend { display: flex; gap: 20px; margin-bottom: 16px; flex-wrap: wrap; align-items: center; padding: 12px; background: #1e1e26; border-radius: 8px; }
        .liq-legend-section { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }
        .liq-legend-title { font-size: 0.7rem; color: #8b8b9a; font-weight: 500; }
        .liq-legend-item { display: flex; align-items: center; gap: 4px; font-size: 0.7rem; color: #b1b1ba; }
        .liq-legend-color { width: 14px; height: 14px; border-radius: 3px; }
        .liq-summary { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 16px; }
        .liq-summary-card { padding: 14px; border-radius: 8px; text-align: center; }
        .liq-summary-card.long-card { background: rgba(248, 113, 113, 0.15); border: 1px solid rgba(248, 113, 113, 0.4); }
        .liq-summary-card.short-card { background: rgba(74, 222, 128, 0.15); border: 1px solid rgba(74, 222, 128, 0.4); }
        .liq-summary-label { font-size: 0.7rem; color: #8b8b9a; margin-bottom: 4px; }
        .liq-summary-value { font-family: 'JetBrains Mono', monospace; font-size: 1.2rem; font-weight: 600; }
        .liq-summary-value.long { color: #f87171; }
        .liq-summary-value.short { color: #4ade80; }
        .liq-chart-box { background: #1e1e26; border-radius: 8px; padding: 16px; }
        .liq-chart-wrapper { height: 350px; position: relative; }
        
        .guide-section { background: #16161d; border: 1px solid #2a2a35; border-radius: 12px; margin-bottom: 20px; overflow: hidden; }
        .guide-header { display: flex; justify-content: space-between; align-items: center; padding: 16px 20px; cursor: pointer; transition: background 0.2s; }
        .guide-header:hover { background: rgba(34, 211, 238, 0.08); }
        .guide-title { font-size: 0.9rem; font-weight: 600; color: #fff; }
        .guide-toggle { display: flex; align-items: center; gap: 6px; color: #8b8b9a; font-size: 0.75rem; }
        .guide-content { max-height: 0; overflow: hidden; transition: max-height 0.3s ease-out; }
        .guide-content.show { max-height: 600px; }
        .guide-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 12px; padding: 0 20px 20px; }
        .guide-card { background: #1e1e26; border: 1px solid #2a2a35; border-radius: 8px; padding: 14px; }
        .guide-card-title { font-size: 0.8rem; font-weight: 600; color: #22d3ee; margin-bottom: 8px; }
        .guide-card-content { font-size: 0.75rem; color: #b1b1ba; line-height: 1.6; }
        
        /* Modal styles */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.75); z-index: 1000; align-items: center; justify-content: center; padding: 20px; }
        .modal-overlay.show { display: flex; }
        .modal { background: #16161d; border: 1px solid #2a2a35; border-radius: 16px; width: 100%; max-width: 800px; max-height: 90vh; overflow: hidden; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; padding: 16px 20px; border-bottom: 1px solid #2a2a35; }
        .modal-title { display: flex; align-items: center; gap: 12px; }
        .modal-coin { font-size: 1.2rem; font-weight: 600; color: #fff; }
        .modal-direction { padding: 4px 10px; border-radius: 6px; font-size: 0.75rem; font-weight: 600; }
        .modal-direction.long { background: rgba(74, 222, 128, 0.2); color: #4ade80; }
        .modal-direction.short { background: rgba(248, 113, 113, 0.2); color: #f87171; }
        .modal-timeframes { display: flex; gap: 4px; }
        .tf-btn { padding: 6px 12px; border-radius: 6px; border: 1px solid #2a2a35; background: transparent; color: #8b8b9a; font-size: 0.75rem; cursor: pointer; transition: all 0.2s; }
        .tf-btn:hover { border-color: #3d3d4a; color: #c1c1ca; }
        .tf-btn.active { border-color: #22d3ee; background: rgba(34, 211, 238, 0.15); color: #22d3ee; }
        .modal-close { background: none; border: none; color: #8b8b9a; cursor: pointer; padding: 8px; border-radius: 8px; transition: all 0.2s; }
        .modal-close:hover { background: #2a2a35; color: #fff; }
        .modal-stats { display: grid; grid-template-columns: repeat(5, 1fr); gap: 12px; padding: 16px 20px; border-bottom: 1px solid #2a2a35; }
        .modal-stat { text-align: center; }
        .modal-stat-label { font-size: 0.65rem; color: #6b6b7a; margin-bottom: 4px; }
        .modal-stat-value { font-family: 'JetBrains Mono', monospace; font-size: 0.85rem; color: #fff; }
        .modal-chart { padding: 20px; height: 350px; position: relative; }
        .modal-loading { position: absolute; top: 0; left: 0; right: 0; bottom: 0; display: flex; align-items: center; justify-content: center; background: rgba(10,10,10,0.9); color: #71717a; gap: 10px; }
        .modal-legend { display: flex; justify-content: center; gap: 20px; padding: 12px 20px; border-top: 1px solid #1a1a1a; }
        .modal-legend-item { display: flex; align-items: center; gap: 6px; font-size: 0.7rem; color: #71717a; }
        .modal-legend-line { width: 20px; height: 2px; }
        .modal-legend-line.entry { border-top: 2px dashed #ef4444; height: 0; }
        .modal-legend-line.current { background: #22d3ee; }
        
        .tooltip { position: fixed; background: #1a1a1a; border: 1px solid #333; border-radius: 8px; padding: 8px 12px; font-size: 0.75rem; color: #e4e4e7; pointer-events: none; z-index: 2000; display: none; max-width: 250px; }
        
        @media (max-width: 768px) {
            .sidebar { display: none; }
            .main-content { margin-left: 0; padding: 16px; }
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .modal-stats { grid-template-columns: repeat(3, 1fr); }
            .dex-tabs { flex-wrap: wrap; }
            .dex-tab { padding: 8px 12px; font-size: 0.75rem; }
        }
    </style>
</head>
<body>
    <nav class="sidebar">
        <div class="logo">
            <div class="logo-icon">PD</div>
            <div><div class="logo-text">Perp DEX</div><span class="logo-sub">Analytics Dashboard</span></div>
        </div>
        <ul class="nav-menu">
            <li class="nav-item active" data-section="overview"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>ê°œìš”</li>
            <li class="nav-item" data-section="funding"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2v20M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>í€ë”©ë¹„</li>
            <li class="nav-item" data-section="liquidation"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M13 2L3 14h9l-1 8 10-12h-9l1-8z"/></svg>ì²­ì‚° ì§€ë„</li>
            <li class="nav-item" data-section="whales"><svg class="nav-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>ê³ ë˜ ì¶”ì ê¸°</li>
        </ul>
    </nav>

    <main class="main-content">
        <!-- Overview Section -->
        <section id="overview" class="section active">
            <div class="status-badge"><div class="status-dot"></div>ì‹¤ì‹œê°„ ì—…ë°ì´íŠ¸</div>
            <div class="page-header"><h1>ğŸ“Š Perp DEX ëŒ€ì‹œë³´ë“œ</h1><p>ë¬´ê¸°í•œ ì„ ë¬¼ DEX ì‹¤ì‹œê°„ ë°ì´í„°</p></div>
            <div class="stats-grid">
                <div class="stat-card"><div class="stat-label">24ì‹œê°„ ê±°ë˜ëŸ‰</div><div class="stat-value" id="stat-vol">-</div></div>
                <div class="stat-card"><div class="stat-label">ë¯¸ê²°ì œì•½ì •</div><div class="stat-value" id="stat-oi">-</div></div>
                <div class="stat-card"><div class="stat-label">í™œì„± ë§ˆì¼“</div><div class="stat-value" id="stat-mkts">-</div></div>
                <div class="stat-card"><div class="stat-label">ì¶”ì  íŠ¸ë ˆì´ë”</div><div class="stat-value" id="stat-traders">-</div></div>
            </div>
            <div class="card">
                <div class="card-header"><h3 class="card-title">ğŸ“ˆ ì‹¤ì‹œê°„ ê°€ê²©</h3><div class="tabs" id="live-tabs"><button class="tab active" data-v="all">ì „ì²´</button><button class="tab" data-v="top">Top 10</button></div></div>
                <div class="table-container"><table><thead><tr><th>ì½”ì¸</th><th>ê°€ê²©</th><th>24h ë³€ë™</th><th>ë¯¸ê²°ì œì•½ì •</th><th>24h ê±°ë˜ëŸ‰</th><th>í€ë”© (1H)</th></tr></thead><tbody id="live-tbody"><tr><td colspan="6"><div class="loading"><div class="loading-spinner"></div>ë¡œë”© ì¤‘...</div></td></tr></tbody></table></div>
            </div>
        </section>

        <!-- Funding Section -->
        <section id="funding" class="section">
            <div class="page-header"><h1>ğŸ’° í€ë”©ë¹„ í˜„í™©</h1><p>ì‹¤ì‹œê°„ í€ë”©ë¹„ ë° ì˜ˆìƒ ì—°ê°„ ìˆ˜ìµë¥ </p></div>
            
            <div class="guide-section">
                <div class="guide-header" onclick="toggleFundingGuide()">
                    <div class="guide-title">ğŸ“š í€ë”©ë¹„ ê°€ì´ë“œ</div>
                    <div class="guide-toggle"><span id="funding-guide-toggle-text">í¼ì¹˜ê¸°</span><svg id="funding-guide-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="transition: transform 0.2s;"><polyline points="6 9 12 15 18 9"></polyline></svg></div>
                </div>
                <div class="guide-content" id="funding-guide-content">
                    <div class="guide-grid">
                        <div class="guide-card"><div class="guide-card-title">ğŸ“ˆ ì–‘ìˆ˜ í€ë”©ë¹„ (ë¡± â†’ ìˆ ì§€ë¶ˆ)</div><div class="guide-card-content">ë¡± í¬ì§€ì…˜ì´ ìˆ í¬ì§€ì…˜ì—ê²Œ í€ë”©ë¹„ë¥¼ ì§€ë¶ˆí•©ë‹ˆë‹¤.<br><br><strong>ì‹œì¥ í•´ì„:</strong> ë¡± í¬ì§€ì…˜ì´ ë§ì•„ ê³¼ì—´ ìƒíƒœì¼ ìˆ˜ ìˆìŒ.<br><strong>ì „ëµ:</strong> ìˆ í¬ì§€ì…˜ ë³´ìœ  ì‹œ í€ë”©ë¹„ ìˆ˜ìµ ë°œìƒ.</div></div>
                        <div class="guide-card"><div class="guide-card-title">ğŸ“‰ ìŒìˆ˜ í€ë”©ë¹„ (ìˆ â†’ ë¡± ì§€ë¶ˆ)</div><div class="guide-card-content">ìˆ í¬ì§€ì…˜ì´ ë¡± í¬ì§€ì…˜ì—ê²Œ í€ë”©ë¹„ë¥¼ ì§€ë¶ˆí•©ë‹ˆë‹¤.<br><br><strong>ì‹œì¥ í•´ì„:</strong> ìˆ í¬ì§€ì…˜ì´ ë§ì•„ ê³¼ë§¤ë„ ìƒíƒœì¼ ìˆ˜ ìˆìŒ.<br><strong>ì „ëµ:</strong> ë¡± í¬ì§€ì…˜ ë³´ìœ  ì‹œ í€ë”©ë¹„ ìˆ˜ìµ ë°œìƒ.</div></div>
                        <div class="guide-card"><div class="guide-card-title">ğŸ’µ APY (ì—°ê°„ ìˆ˜ìµë¥ )</div><div class="guide-card-content">í˜„ì¬ í€ë”©ë¹„ê°€ 1ë…„ê°„ ì§€ì†ëœë‹¤ê³  ê°€ì •í•œ ì—°ê°„ ìˆ˜ìµë¥ ì…ë‹ˆë‹¤.<br><br><strong>ê³„ì‚°:</strong> í€ë”©ë¹„(1H) Ã— 24 Ã— 365<br><strong>ì°¸ê³ :</strong> ì‹¤ì œ ìˆ˜ìµë¥ ì€ ì‹œì¥ ìƒí™©ì— ë”°ë¼ ë³€ë™ë©ë‹ˆë‹¤.</div></div>
                        <div class="guide-card"><div class="guide-card-title">âš¡ í™œìš© íŒ</div><div class="guide-card-content">â€¢ <strong>ë¸íƒ€ ë‰´íŠ¸ëŸ´:</strong> í˜„ë¬¼ ë¡± + ì„ ë¬¼ ìˆìœ¼ë¡œ í€ë”©ë¹„ ìˆ˜ìµë§Œ ì¶”êµ¬<br>â€¢ <strong>ë†’ì€ APY</strong>: ìˆ˜ìµ ê¸°íšŒì´ì§€ë§Œ ê¸‰ê²©í•œ ë³€ë™ ì£¼ì˜<br>â€¢ <strong>ìŒìˆ˜ APY ì§€ì†</strong>: ì•½ì„¸ì¥ ì‹ í˜¸ì¼ ìˆ˜ ìˆìŒ</div></div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header"><h3 class="card-title">ì‹¤ì‹œê°„ í€ë”©ë¹„</h3></div>
                <div class="table-container"><table id="funding"><thead><tr><th>ì½”ì¸</th><th class="sortable" data-sort="funding">í€ë”© (1H)</th><th class="sortable" data-sort="apy">ì—°ê°„ APY</th><th>ë‹¤ìŒ í€ë”©ê¹Œì§€</th><th class="sortable" data-sort="oi">ë¯¸ê²°ì œì•½ì •</th></tr></thead><tbody id="funding-tbody"><tr><td colspan="5"><div class="loading"><div class="loading-spinner"></div>ë¡œë”© ì¤‘...</div></td></tr></tbody></table></div>
            </div>
        </section>

        <!-- Liquidation Map -->
        <section id="liquidation" class="section">
            <div class="page-header"><h1>âš ï¸ ì²­ì‚° ì§€ë„</h1><p>Top 500 íŠ¸ë ˆì´ë” ê¸°ì¤€ ì²­ì‚° ê°€ê²© ë¶„í¬</p></div>
            
            <!-- DEX Tabs for Liquidation -->
            <div class="dex-tabs" id="liq-dex-tabs">
                <button class="dex-tab active" data-dex="hyperliquid">
                    <img src="https://app.hyperliquid.xyz/favicon.ico" alt="HL" onerror="this.style.display='none'">
                    <span class="dex-name">Hyperliquid</span>
                </button>
            </div>
            
            <div class="card">
                <div class="liq-header-row">
                    <div class="controls-row"><select id="liq-coin"><option value="">ë¡œë”© ì¤‘...</option></select></div>
                    <div class="liq-price-box"><div class="liq-price-label">í˜„ì¬ ê°€ê²©</div><div class="liq-price-value" id="liq-current-price">-</div></div>
                </div>
                <div class="liq-legend">
                    <div class="liq-legend-section">
                        <span class="liq-legend-title">ë ˆë²„ë¦¬ì§€:</span>
                        <div class="liq-legend-item"><div class="liq-legend-color" style="background:#3b82f6"></div>10x</div>
                        <div class="liq-legend-item"><div class="liq-legend-color" style="background:#eab308"></div>25x</div>
                        <div class="liq-legend-item"><div class="liq-legend-color" style="background:#f97316"></div>50x</div>
                        <div class="liq-legend-item"><div class="liq-legend-color" style="background:#ef4444"></div>100x</div>
                    </div>
                </div>
                <div class="liq-summary">
                    <div class="liq-summary-card long-card"><div class="liq-summary-label">ëˆ„ì  ë¡± ì²­ì‚°</div><div class="liq-summary-value long" id="liq-total-long">-</div></div>
                    <div class="liq-summary-card short-card"><div class="liq-summary-label">ëˆ„ì  ìˆ ì²­ì‚°</div><div class="liq-summary-value short" id="liq-total-short">-</div></div>
                </div>
                <div class="liq-chart-box"><div class="liq-chart-wrapper"><canvas id="liq-chart"></canvas></div></div>
            </div>

            <div class="guide-section">
                <div class="guide-header" onclick="toggleGuide()">
                    <div class="guide-title">ğŸ“Š ì²­ì‚° ì§€ë„ í™œìš© ê°€ì´ë“œ</div>
                    <div class="guide-toggle"><span id="guide-toggle-text">í¼ì¹˜ê¸°</span><svg id="guide-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="transition: transform 0.2s;"><polyline points="6 9 12 15 18 9"></polyline></svg></div>
                </div>
                <div class="guide-content" id="guide-content">
                    <div class="guide-grid">
                        <div class="guide-card"><div class="guide-card-title">ğŸ”´ ë¡± ì²­ì‚° êµ¬ê°„ (ì•„ë˜ìª½)</div><div class="guide-card-content">í˜„ì¬ê°€ ì•„ë˜ì— ë¡± ì²­ì‚°ì´ ìŒ“ì—¬ìˆìœ¼ë©´,<br>ê°€ê²© í•˜ë½ ì‹œ <strong class="bearish">ì—°ì‡„ ì²­ì‚°</strong>ìœ¼ë¡œ ê¸‰ë½ ê°€ëŠ¥.<br><br><strong>íŠ¸ë ˆì´ë”© íŒíŠ¸:</strong> ë¡± ì²­ì‚°ì´ ë§ì€ ê°€ê²©ëŒ€ëŠ” ê°•í•œ ì§€ì§€ì„ ì´ ë˜ê±°ë‚˜, ëš«ë¦¬ë©´ ê¸‰ë½ íŠ¸ë¦¬ê±°ê°€ ë¨.</div></div>
                        <div class="guide-card"><div class="guide-card-title">ğŸŸ¢ ìˆ ì²­ì‚° êµ¬ê°„ (ìœ„ìª½)</div><div class="guide-card-content">í˜„ì¬ê°€ ìœ„ì— ìˆ ì²­ì‚°ì´ ìŒ“ì—¬ìˆìœ¼ë©´,<br>ê°€ê²© ìƒìŠ¹ ì‹œ <strong class="bullish">ìˆ ìŠ¤í€´ì¦ˆ</strong>ë¡œ ê¸‰ë“± ê°€ëŠ¥.<br><br><strong>íŠ¸ë ˆì´ë”© íŒíŠ¸:</strong> ìˆ ì²­ì‚°ì´ ë§ì€ ê°€ê²©ëŒ€ëŠ” ì €í•­ì„ ì´ ë˜ê±°ë‚˜, ëš«ë¦¬ë©´ ê¸‰ë“± íŠ¸ë¦¬ê±°ê°€ ë¨.</div></div>
                        <div class="guide-card"><div class="guide-card-title">ğŸ“ˆ ë ˆë²„ë¦¬ì§€ ìƒ‰ìƒ</div><div class="guide-card-content"><strong style="color:#3b82f6">â–  10x</strong> - ë‚®ì€ ë ˆë²„ë¦¬ì§€ (ì•ˆì •ì )<br><strong style="color:#eab308">â–  25x</strong> - ì¤‘ê°„ ë ˆë²„ë¦¬ì§€<br><strong style="color:#f97316">â–  50x</strong> - ë†’ì€ ë ˆë²„ë¦¬ì§€<br><strong style="color:#ef4444">â–  100x</strong> - ê·¹ë‹¨ì  ë ˆë²„ë¦¬ì§€ (ë³€ë™ì„± ì·¨ì•½)</div></div>
                        <div class="guide-card"><div class="guide-card-title">ğŸ’¡ í™œìš© íŒ</div><div class="guide-card-content">â€¢ <strong>ì²­ì‚° ë°€ì§‘ êµ¬ê°„</strong>: ê°€ê²© ë„ë‹¬ ì‹œ ê¸‰ê²©í•œ ì›€ì§ì„ ì˜ˆìƒ<br>â€¢ <strong>ëˆ„ì  ë¼ì¸</strong>: ì–´ëŠ ë°©í–¥ì— ë” ë§ì€ ì²­ì‚°ì´ ìˆëŠ”ì§€ íŒŒì•…<br>â€¢ <strong>ê³ ë ˆë²„ë¦¬ì§€</strong>: ì‘ì€ ê°€ê²© ë³€ë™ì—ë„ ì²­ì‚° ë°œìƒ</div></div>
                    </div>
                </div>
            </div>
            <div class="last-updated" id="liq-last-updated"></div>
        </section>

        <!-- Whales -->
        <section id="whales" class="section">
            <div class="page-header"><h1>ğŸ‹ ê³ ë˜ ì¶”ì ê¸°</h1><p>ìƒìœ„ íŠ¸ë ˆì´ë” í¬ì§€ì…˜ ë° PnL ë¶„ì„</p></div>
            
            <!-- DEX Tabs for Whales -->
            <div class="dex-tabs" id="whale-dex-tabs">
                <button class="dex-tab active" data-dex="hyperliquid">
                    <img src="https://app.hyperliquid.xyz/favicon.ico" alt="HL" onerror="this.style.display='none'">
                    <span class="dex-name">Hyperliquid</span>
                </button>
            </div>
            
            <!-- Whale Tracker Guide -->
            <div class="guide-section">
                <div class="guide-header" onclick="toggleWhaleGuide()">
                    <div class="guide-title">ğŸ’¡ ê³ ë˜ ì¶”ì ê¸° í™œìš© ê°€ì´ë“œ</div>
                    <div class="guide-toggle"><span id="whale-guide-toggle-text">í¼ì¹˜ê¸°</span><svg id="whale-guide-arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="transition: transform 0.2s;"><polyline points="6 9 12 15 18 9"></polyline></svg></div>
                </div>
                <div class="guide-content" id="whale-guide-content">
                    <div class="guide-grid">
                        <div class="guide-card"><div class="guide-card-title">ğŸ“Š í¬ì§€ì…˜ ì§‘ê³„ ì°¨íŠ¸</div><div class="guide-card-content">ìƒìœ„ íŠ¸ë ˆì´ë”ë“¤ì˜ í¬ì§€ì…˜ì„ ì½”ì¸ë³„ë¡œ ì§‘ê³„í•©ë‹ˆë‹¤.<br><strong class="bullish">ì˜¤ë¥¸ìª½(ë¡±)</strong> vs <strong class="bearish">ì™¼ìª½(ìˆ)</strong><br>ê³ ë˜ë“¤ì´ ì–´ë–¤ ì½”ì¸ì— ë² íŒ…í•˜ëŠ”ì§€ íŒŒì•…í•˜ì„¸ìš”.</div></div>
                        <div class="guide-card"><div class="guide-card-title">ğŸ“ˆ PnL vs í¬ì§€ì…˜ ì‚¬ì´ì¦ˆ</div><div class="guide-card-content"><strong>PnL ìƒìœ„ 500</strong>: ìˆ˜ìµ ê¸°ì¤€ ì •ë ¬<br>â†’ ì‹¤ë ¥ ìˆëŠ” íŠ¸ë ˆì´ë” ì¶”ì <br><strong>í¬ì§€ì…˜ ì‚¬ì´ì¦ˆ ê¸°ì¤€</strong>: ê·œëª¨ ê¸°ì¤€<br>â†’ ìê¸ˆë ¥ ìˆëŠ” íŠ¸ë ˆì´ë” ì¶”ì </div></div>
                        <div class="guide-card"><div class="guide-card-title">ğŸ” íŠ¸ë ˆì´ë” ìƒì„¸ ë³´ê¸°</div><div class="guide-card-content">í…Œì´ë¸”ì—ì„œ <strong>â–¼ ë²„íŠ¼</strong>ì„ í´ë¦­í•˜ë©´<br>í•´ë‹¹ íŠ¸ë ˆì´ë”ì˜ ê°œë³„ í¬ì§€ì…˜ì´ í¼ì³ì§‘ë‹ˆë‹¤.<br>ê° í¬ì§€ì…˜ì˜ ì½”ì¸, ë°©í–¥, ì§„ì…ê°€ë¥¼ í™•ì¸í•˜ì„¸ìš”.</div></div>
                        <div class="guide-card"><div class="guide-card-title">ğŸ“‰ ì§„ì…ê°€ ì°¨íŠ¸ ë³´ê¸°</div><div class="guide-card-content">í¼ì³ì§„ <strong>í¬ì§€ì…˜ ì¹´ë“œë¥¼ í´ë¦­</strong>í•˜ë©´<br>ê°€ê²© ì°¨íŠ¸ì™€ í•¨ê»˜ <strong class="bearish">ì§„ì…ê°€ ë¼ì¸</strong>ì´ í‘œì‹œë©ë‹ˆë‹¤.<br>ê³ ë˜ê°€ ì–´ë””ì„œ ì§„ì…í–ˆëŠ”ì§€ ì‹œê°ì ìœ¼ë¡œ í™•ì¸!</div></div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">ğŸ“Š íƒ‘ íŠ¸ë ˆì´ë” í¬ì§€ì…˜ ì§‘ê³„</h3>
                    <div class="controls-row">
                        <div class="tabs" id="pos-data-tabs"><button class="tab active" data-v="pnl">PnL ìƒìœ„ 500</button><button class="tab" data-v="size">ìƒìœ„ 500 í¬ì§€ì…˜ ì‚¬ì´ì¦ˆ</button></div>
                        <div class="tabs" id="pos-period-tabs"><button class="tab active" data-v="daily">ì¼ê°„</button><button class="tab" data-v="weekly">ì£¼ê°„</button></div>
                        <div class="tabs" id="pos-unit-tabs"><button class="tab active" data-v="value">ê¸ˆì•¡($)</button><button class="tab" data-v="size">ìˆ˜ëŸ‰</button></div>
                    </div>
                </div>
                <div class="chart-legend"><div class="legend-item"><div class="legend-dot short"></div>ìˆ</div><div class="legend-item"><div class="legend-dot long"></div>ë¡±</div></div>
                <div class="chart-container"><div id="pos-chart" class="bar-chart"></div></div>
            </div>
            <div class="sub-tabs"><button class="sub-tab active" data-tab="pnl">ğŸ“ˆ PnL ìƒìœ„ íŠ¸ë ˆì´ë”</button><button class="sub-tab" data-tab="biggest">ğŸ’ ìµœëŒ€ í¬ì§€ì…˜ (OI)</button></div>
            <div id="pnl-section"><div class="card"><div class="card-header"><h3 class="card-title">PnL ìƒìœ„ 500</h3><div class="tabs" id="trader-tabs"><button class="tab active" data-v="daily">ì¼ê°„</button><button class="tab" data-v="weekly">ì£¼ê°„</button></div></div><div class="table-container"><table><thead><tr><th>ìˆœìœ„</th><th>íŠ¸ë ˆì´ë”</th><th>ê³„ì¢Œ ê°€ì¹˜</th><th>ìˆ˜ìµ (PnL)</th><th>ìˆ˜ìµë¥ </th><th>ê±°ë˜ëŸ‰</th><th></th></tr></thead><tbody id="pnl-tbody"><tr><td colspan="7"><div class="loading"><div class="loading-spinner"></div>ë¡œë”© ì¤‘...</div></td></tr></tbody></table></div></div></div>
            <div id="biggest-section" style="display:none;"><div class="card"><div class="card-header"><h3 class="card-title">ìµœëŒ€ í¬ì§€ì…˜ ìƒìœ„ 500</h3></div><div class="table-container"><table><thead><tr><th>ìˆœìœ„</th><th>ì½”ì¸</th><th>ë°©í–¥</th><th>í¬ì§€ì…˜ ê°€ì¹˜</th><th>ìˆ˜ëŸ‰</th><th>ì§„ì…ê°€</th><th>ë ˆë²„ë¦¬ì§€</th><th>ë¯¸ì‹¤í˜„ PnL</th><th>íŠ¸ë ˆì´ë”</th></tr></thead><tbody id="biggest-tbody"><tr><td colspan="9"><div class="loading"><div class="loading-spinner"></div>ë¡œë”© ì¤‘...</div></td></tr></tbody></table></div></div></div>
        </section>

        <div class="last-updated" id="last-updated"></div>
    </main>

    <!-- Position Chart Modal -->
    <div class="modal-overlay" id="position-modal">
        <div class="modal">
            <div class="modal-header">
                <div class="modal-title">
                    <span class="modal-coin" id="modal-coin">BTC</span>
                    <span class="modal-direction" id="modal-direction">LONG</span>
                </div>
                <div class="modal-timeframes">
                    <button class="tf-btn" data-tf="5m">5m</button>
                    <button class="tf-btn" data-tf="15m">15m</button>
                    <button class="tf-btn active" data-tf="1h">1h</button>
                    <button class="tf-btn" data-tf="4h">4h</button>
                    <button class="tf-btn" data-tf="1D">1D</button>
                </div>
                <button class="modal-close" onclick="closePositionModal()">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
                </button>
            </div>
            <div class="modal-stats">
                <div class="modal-stat"><div class="modal-stat-label">Size</div><div class="modal-stat-value" id="modal-size">-</div></div>
                <div class="modal-stat"><div class="modal-stat-label">Entry</div><div class="modal-stat-value" id="modal-entry">-</div></div>
                <div class="modal-stat"><div class="modal-stat-label">Current</div><div class="modal-stat-value" id="modal-current">-</div></div>
                <div class="modal-stat"><div class="modal-stat-label">Leverage</div><div class="modal-stat-value" id="modal-leverage">-</div></div>
                <div class="modal-stat"><div class="modal-stat-label">Unrealized PnL</div><div class="modal-stat-value" id="modal-pnl">-</div></div>
            </div>
            <div class="modal-chart">
                <canvas id="position-chart"></canvas>
                <div class="modal-loading" id="modal-loading"><div class="loading-spinner"></div>ì°¨íŠ¸ ë¡œë”© ì¤‘...</div>
            </div>
            <div class="modal-legend">
                <div class="modal-legend-item"><div class="modal-legend-line entry" style="border-top: 2px dashed #ef4444; height: 0;"></div>Entry Price</div>
                <div class="modal-legend-item"><div class="modal-legend-line current"></div>Current Price</div>
            </div>
        </div>
    </div>

    <div class="tooltip" id="tooltip"></div>

    <script>
        // DEX Configuration
        const DEX_CONFIG = {
            hyperliquid: { name: 'Hyperliquid', whaleFile: 'data/hyperliquid_whales.json', liqFile: 'data/hyperliquid_liq.json', explorerUrl: 'https://app.hyperliquid.xyz/explorer/address/', color: '#22d3ee' }
        };

        let currentWhaleDex = 'hyperliquid', currentLiqDex = 'hyperliquid';
        let whaleData = {}, liqData = {}, live = null, liqChart = null, positionChart = null;
        let guideExpanded = false, fundingGuideExpanded = false, whaleGuideExpanded = false;
        let posData = 'pnl', posPeriod = 'daily', posUnit = 'value', traderPeriod = 'daily';
        let selectedLiqCoin = 'BTC';
        let fundingSortField = 'funding', fundingSortDir = 'desc';
        let currentPosition = null, currentTimeframe = '1h';

        const fmt = {
            usd: v => { const n = Math.abs(parseFloat(v)||0); return (v<0?'-':'')+'$'+(n>=1e9?(n/1e9).toFixed(2)+'B':n>=1e6?(n/1e6).toFixed(2)+'M':n>=1e3?(n/1e3).toFixed(1)+'K':n.toFixed(0)); },
            pct: v => { const n = parseFloat(v)||0; return (n>=0?'+':'')+n.toFixed(2)+'%'; },
            pctDec: v => { const n = (parseFloat(v)||0)*100; return (n>=0?'+':'')+n.toFixed(2)+'%'; },
            fund: v => { const n = parseFloat(v)||0; return (n>=0?'+':'')+n.toFixed(4)+'%'; },
            px: (v, coin) => { const n = parseFloat(v)||0; if (coin === 'PEPE' || n < 0.001) return '$' + n.toFixed(8); if (n < 1) return '$' + n.toFixed(4); if (n < 100) return '$' + n.toFixed(2); return '$' + n.toLocaleString('en-US', { maximumFractionDigits: 0 }); },
            num: v => { const n = parseFloat(v)||0; return Math.abs(n)>=1e6?(n/1e6).toFixed(2)+'M':Math.abs(n)>=1e3?(n/1e3).toFixed(1)+'K':n.toFixed(2); },
            addr: a => a ? a.slice(0,6)+'...'+a.slice(-4) : '-'
        };

        function toggleGuide() { guideExpanded = !guideExpanded; document.getElementById('guide-content').classList.toggle('show', guideExpanded); document.getElementById('guide-toggle-text').textContent = guideExpanded ? 'ì ‘ê¸°' : 'í¼ì¹˜ê¸°'; document.getElementById('guide-arrow').style.transform = guideExpanded ? 'rotate(180deg)' : 'rotate(0deg)'; }
        function toggleFundingGuide() { fundingGuideExpanded = !fundingGuideExpanded; document.getElementById('funding-guide-content').classList.toggle('show', fundingGuideExpanded); document.getElementById('funding-guide-toggle-text').textContent = fundingGuideExpanded ? 'ì ‘ê¸°' : 'í¼ì¹˜ê¸°'; document.getElementById('funding-guide-arrow').style.transform = fundingGuideExpanded ? 'rotate(180deg)' : 'rotate(0deg)'; }
        function toggleWhaleGuide() { whaleGuideExpanded = !whaleGuideExpanded; document.getElementById('whale-guide-content').classList.toggle('show', whaleGuideExpanded); document.getElementById('whale-guide-toggle-text').textContent = whaleGuideExpanded ? 'ì ‘ê¸°' : 'í¼ì¹˜ê¸°'; document.getElementById('whale-guide-arrow').style.transform = whaleGuideExpanded ? 'rotate(180deg)' : 'rotate(0deg)'; }

        function sortFunding(field) { if (fundingSortField === field) { fundingSortDir = fundingSortDir === 'desc' ? 'asc' : 'desc'; } else { fundingSortField = field; fundingSortDir = 'desc'; } document.querySelectorAll('#funding th.sortable').forEach(th => { th.classList.remove('sort-active'); if (th.dataset.sort === field) th.classList.add('sort-active'); }); renderFunding(); }

        async function fetchLive() {
            try {
                const r = await fetch('https://api.hyperliquid.xyz/info', { method: 'POST', headers: {'Content-Type':'application/json'}, body: JSON.stringify({type:'metaAndAssetCtxs'}) });
                const m = await r.json();
                if (m?.length >= 2) {
                    live = {}; let oi = 0, vol = 0;
                    m[0].universe.forEach((a, i) => { if (i < m[1].length) { const c = m[1][i], mark = parseFloat(c.markPx)||0, o = parseFloat(c.openInterest)||0, v = parseFloat(c.dayNtlVlm)||0, prev = parseFloat(c.prevDayPx)||0; live[a.name] = { name: a.name, markPx: mark, indexPx: parseFloat(c.oraclePx)||mark, change24h: prev>0?((mark-prev)/prev)*100:0, volume24h: v, openInterest: o*mark, openInterestCoins: o, funding: (parseFloat(c.funding)||0)*100, maxLeverage: a.maxLeverage||0 }; oi += o*mark; vol += v; } });
                    document.getElementById('stat-vol').textContent = fmt.usd(vol); document.getElementById('stat-oi').textContent = fmt.usd(oi); document.getElementById('stat-mkts').textContent = Object.keys(live).length; renderLive(); renderFunding();
                }
            } catch(e) { console.error(e); }
        }

        function getMarkets() { return live ? Object.values(live).sort((a,b) => b.openInterest - a.openInterest) : []; }
        function renderLive() { if (!live) return; const mode = document.querySelector('#live-tabs .tab.active')?.dataset.v || 'all'; let mkts = getMarkets(); if (mode === 'top') mkts = mkts.slice(0, 10); document.getElementById('live-tbody').innerHTML = mkts.map(m => `<tr><td class="coin-name">${m.name}</td><td>${fmt.px(m.markPx, m.name)}</td><td class="${m.change24h>=0?'positive':'negative'}">${fmt.pct(m.change24h)}</td><td>${fmt.usd(m.openInterest)}</td><td>${fmt.usd(m.volume24h)}</td><td class="${m.funding>=0?'positive':'negative'}">${fmt.fund(m.funding)}</td></tr>`).join(''); }
        function renderFunding() { if (!live) return; let mkts = getMarkets(); if (fundingSortField === 'funding') { mkts.sort((a,b) => fundingSortDir === 'desc' ? b.funding - a.funding : a.funding - b.funding); } else if (fundingSortField === 'apy') { mkts.sort((a,b) => { const aa = a.funding * 24 * 365, bb = b.funding * 24 * 365; return fundingSortDir === 'desc' ? bb - aa : aa - bb; }); } else if (fundingSortField === 'oi') { mkts.sort((a,b) => fundingSortDir === 'desc' ? b.openInterest - a.openInterest : a.openInterest - b.openInterest); } const now = new Date(), mins = 60 - now.getMinutes(), secs = 60 - now.getSeconds(), countdown = `${mins-1}ë¶„ ${secs}ì´ˆ`; document.getElementById('funding-tbody').innerHTML = mkts.map(m => { const apy = m.funding * 24 * 365; return `<tr><td class="coin-name">${m.name}</td><td class="${m.funding>=0?'positive':'negative'}">${fmt.fund(m.funding)}</td><td class="${apy>=0?'positive':'negative'}">${fmt.pct(apy)}</td><td>${countdown}</td><td>${fmt.usd(m.openInterest)}</td></tr>`; }).join(''); }

        async function loadWhaleData(dex) { const config = DEX_CONFIG[dex]; if (!config) return; try { const r = await fetch(config.whaleFile); if (!r.ok) throw new Error('Not found'); whaleData[dex] = await r.json(); if (dex === currentWhaleDex) { renderPnL(); renderBiggest(); renderPosChart(); updateWhaleLastUpdated(); } } catch(e) { console.log(`${dex} whale data not found`); whaleData[dex] = null; if (dex === currentWhaleDex) { document.getElementById('pnl-tbody').innerHTML = '<tr><td colspan="7"><div class="no-data">ë°ì´í„° ì¤€ë¹„ ì¤‘... ğŸ”„</div></td></tr>'; document.getElementById('biggest-tbody').innerHTML = '<tr><td colspan="9"><div class="no-data">ë°ì´í„° ì¤€ë¹„ ì¤‘... ğŸ”„</div></td></tr>'; document.getElementById('pos-chart').innerHTML = '<div class="no-data">ë°ì´í„° ì¤€ë¹„ ì¤‘... ğŸ”„</div>'; } } }
        async function loadLiqData(dex) { const config = DEX_CONFIG[dex]; if (!config) return; try { const r = await fetch(config.liqFile); if (!r.ok) throw new Error('Not found'); liqData[dex] = await r.json(); if (dex === currentLiqDex) { populateLiqCoins(); updateLiqLastUpdated(); } } catch(e) { console.log(`${dex} liquidation data not found`); liqData[dex] = null; if (dex === currentLiqDex) { document.getElementById('liq-coin').innerHTML = '<option value="">ë°ì´í„° ì¤€ë¹„ ì¤‘...</option>'; if (liqChart) { liqChart.destroy(); liqChart = null; } } } }

        function updateWhaleLastUpdated() { const data = whaleData[currentWhaleDex]; if (data?.lastUpdated) { const d = new Date(data.lastUpdated); document.getElementById('last-updated').textContent = `${DEX_CONFIG[currentWhaleDex].name} ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${d.getFullYear()}ë…„ ${d.getMonth()+1}ì›” ${d.getDate()}ì¼ ${d.getHours().toString().padStart(2,'0')}:${d.getMinutes().toString().padStart(2,'0')} UTC`; } else { document.getElementById('last-updated').textContent = ''; } if (data?.dashboard?.totalTraders) { document.getElementById('stat-traders').textContent = data.dashboard.totalTraders.toLocaleString(); } }
        function updateLiqLastUpdated() { const data = liqData[currentLiqDex]; if (data?.lastUpdated) { const d = new Date(data.lastUpdated); document.getElementById('liq-last-updated').textContent = `${DEX_CONFIG[currentLiqDex].name} ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${d.getFullYear()}ë…„ ${d.getMonth()+1}ì›” ${d.getDate()}ì¼ ${d.getHours().toString().padStart(2,'0')}:${d.getMinutes().toString().padStart(2,'0')} (${data.tradersCount || 0}ëª… íŠ¸ë ˆì´ë”)`; } else { document.getElementById('liq-last-updated').textContent = ''; } }

        function updateLiqChart() { const data = liqData[currentLiqDex]; if (!data?.data?.[selectedLiqCoin]) { if (liqChart) { liqChart.destroy(); liqChart = null; } return; } const coinData = data.data[selectedLiqCoin]; document.getElementById('liq-current-price').textContent = fmt.px(coinData.currentPrice, selectedLiqCoin); const longData = coinData.longLiquidations || [], shortData = coinData.shortLiquidations || []; const totalLong = longData.reduce((s, d) => s + (d['10x']||0) + (d['25x']||0) + (d['50x']||0) + (d['100x']||0), 0), totalShort = shortData.reduce((s, d) => s + (d['10x']||0) + (d['25x']||0) + (d['50x']||0) + (d['100x']||0), 0); document.getElementById('liq-total-long').textContent = fmt.usd(totalLong); document.getElementById('liq-total-short').textContent = fmt.usd(totalShort); const allPrices = [...new Set([...longData.map(d => d.price), ...shortData.map(d => d.price)])].sort((a, b) => a - b); const longMap = {}, shortMap = {}; longData.forEach(d => longMap[d.price] = d); shortData.forEach(d => shortMap[d.price] = d); const labels = allPrices.map(p => fmt.px(p, selectedLiqCoin)); const long10x = allPrices.map(p => longMap[p] ? -longMap[p]['10x'] : 0), long25x = allPrices.map(p => longMap[p] ? -longMap[p]['25x'] : 0), long50x = allPrices.map(p => longMap[p] ? -longMap[p]['50x'] : 0), long100x = allPrices.map(p => longMap[p] ? -longMap[p]['100x'] : 0); const short10x = allPrices.map(p => shortMap[p] ? shortMap[p]['10x'] : 0), short25x = allPrices.map(p => shortMap[p] ? shortMap[p]['25x'] : 0), short50x = allPrices.map(p => shortMap[p] ? shortMap[p]['50x'] : 0), short100x = allPrices.map(p => shortMap[p] ? shortMap[p]['100x'] : 0); let currentPriceIndex = allPrices.findIndex(p => p >= coinData.currentPrice); if (currentPriceIndex === -1) currentPriceIndex = allPrices.length - 1; if (liqChart) liqChart.destroy(); const ctx = document.getElementById('liq-chart').getContext('2d'); liqChart = new Chart(ctx, { type: 'bar', data: { labels: labels, datasets: [ { label: 'Long 10x', data: long10x, backgroundColor: '#3b82f6aa', stack: 'long', maxBarThickness: 50, barPercentage: 0.85, categoryPercentage: 0.85 }, { label: 'Long 25x', data: long25x, backgroundColor: '#eab308aa', stack: 'long', maxBarThickness: 50, barPercentage: 0.85, categoryPercentage: 0.85 }, { label: 'Long 50x', data: long50x, backgroundColor: '#f97316aa', stack: 'long', maxBarThickness: 50, barPercentage: 0.85, categoryPercentage: 0.85 }, { label: 'Long 100x', data: long100x, backgroundColor: '#ef4444aa', stack: 'long', maxBarThickness: 50, barPercentage: 0.85, categoryPercentage: 0.85 }, { label: 'Short 10x', data: short10x, backgroundColor: '#3b82f6aa', stack: 'short', maxBarThickness: 50, barPercentage: 0.85, categoryPercentage: 0.85 }, { label: 'Short 25x', data: short25x, backgroundColor: '#eab308aa', stack: 'short', maxBarThickness: 50, barPercentage: 0.85, categoryPercentage: 0.85 }, { label: 'Short 50x', data: short50x, backgroundColor: '#f97316aa', stack: 'short', maxBarThickness: 50, barPercentage: 0.85, categoryPercentage: 0.85 }, { label: 'Short 100x', data: short100x, backgroundColor: '#ef4444aa', stack: 'short', maxBarThickness: 50, barPercentage: 0.85, categoryPercentage: 0.85 } ] }, options: { responsive: true, maintainAspectRatio: false, interaction: { intersect: false, mode: 'index' }, plugins: { legend: { display: false }, tooltip: { callbacks: { title: items => 'ê°€ê²©: ' + items[0].label, label: ctx => { const v = Math.abs(ctx.raw); return v === 0 ? null : ctx.dataset.label + ': ' + fmt.usd(v); } }, filter: item => item.raw !== 0 } }, scales: { x: { stacked: true, grid: { color: '#2a2a35' }, ticks: { color: '#8b8b9a', maxRotation: 45, minRotation: 45, autoSkip: true, maxTicksLimit: 15 } }, y: { stacked: true, grid: { color: '#2a2a35' }, ticks: { color: '#8b8b9a', callback: v => fmt.usd(Math.abs(v)) } } } }, plugins: [{ id: 'currentPriceLine', afterDraw: function(chart) { const ctx = chart.ctx; const xAxis = chart.scales.x; const yAxis = chart.scales.y; const x = xAxis.getPixelForValue(currentPriceIndex); ctx.save(); ctx.beginPath(); ctx.setLineDash([5, 5]); ctx.strokeStyle = '#22d3ee'; ctx.lineWidth = 2; ctx.moveTo(x, yAxis.top); ctx.lineTo(x, yAxis.bottom); ctx.stroke(); ctx.restore(); } }] }); }

        function populateLiqCoins() { const data = liqData[currentLiqDex]; if (!data) { document.getElementById('liq-coin').innerHTML = '<option value="">ë°ì´í„° ì—†ìŒ</option>'; return; } const sel = document.getElementById('liq-coin'); sel.innerHTML = ''; let first = null; (data.coins || Object.keys(data.data || {})).forEach(coin => { const d = data.data?.[coin]; if (d && (d.longLiquidations?.length > 0 || d.shortLiquidations?.length > 0)) { const opt = document.createElement('option'); opt.value = coin; opt.textContent = coin + '/USD'; if (!first) { opt.selected = true; first = coin; } sel.appendChild(opt); } }); if (!first) sel.innerHTML = '<option value="">ë°ì´í„° ì—†ìŒ</option>'; else selectedLiqCoin = first; updateLiqChart(); }

        function getExplorerUrl(address) { return DEX_CONFIG[currentWhaleDex].explorerUrl + address; }

        function renderPnL() { const data = whaleData[currentWhaleDex]; const traders = traderPeriod === 'daily' ? data?.whaleTracker?.daily : data?.whaleTracker?.weekly; if (!traders) { document.getElementById('pnl-tbody').innerHTML = '<tr><td colspan="7"><div class="no-data">ë°ì´í„° ì—†ìŒ</div></td></tr>'; return; } document.getElementById('pnl-tbody').innerHTML = traders.map((t,i) => { const name = t.displayName || fmt.addr(t.address), hasPos = t.positions?.length > 0; return `<tr><td><span class="rank ${i<3?'top3':''}">#${i+1}</span></td><td class="address"><a href="${getExplorerUrl(t.address)}" target="_blank">${name}</a></td><td>${fmt.usd(t.accountValue)}</td><td class="${t.pnl>=0?'positive':'negative'}">${fmt.usd(t.pnl)}</td><td class="${t.roi>=0?'positive':'negative'}">${fmt.pctDec(t.roi)}</td><td>${fmt.usd(t.volume)}</td><td>${hasPos?`<button class="expand-btn" onclick="togglePos(${i})"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg></button>`:''}</td></tr>${hasPos?`<tr class="positions-row" id="pos-${i}"><td colspan="7"><div class="positions-content"><div class="positions-grid">${t.positions.map((p,pi) => `<div class="position-card" onclick="openPositionModal(${i}, ${pi})"><div class="position-header"><span class="position-coin">${p.coin}</span><span class="direction ${p.direction.toLowerCase()}">${p.direction==='Long'?'ë¡±':'ìˆ'}</span></div><div class="position-details"><div class="position-detail"><span class="position-detail-label">ê°€ì¹˜</span><span class="position-detail-value">${fmt.usd(p.positionValue)}</span></div><div class="position-detail"><span class="position-detail-label">ë ˆë²„ë¦¬ì§€</span><span class="position-detail-value">${p.leverage}x</span></div><div class="position-detail"><span class="position-detail-label">ì§„ì…ê°€</span><span class="position-detail-value">${fmt.px(p.entryPx, p.coin)}</span></div><div class="position-detail"><span class="position-detail-label">ë¯¸ì‹¤í˜„</span><span class="position-detail-value ${p.unrealizedPnl>=0?'positive':'negative'}">${fmt.usd(p.unrealizedPnl)}</span></div></div><div class="position-hint">ğŸ“ˆ í´ë¦­í•˜ì—¬ ì°¨íŠ¸ ë³´ê¸°</div></div>`).join('')}</div></div></td></tr>`:''}`;}).join(''); }
        function renderBiggest() { const data = whaleData[currentWhaleDex]; const pos = data?.whaleTracker?.biggestPositions || []; if (!pos.length) { document.getElementById('biggest-tbody').innerHTML = '<tr><td colspan="9"><div class="no-data">ë°ì´í„° ì—†ìŒ</div></td></tr>'; return; } document.getElementById('biggest-tbody').innerHTML = pos.map((p,i) => `<tr><td><span class="rank ${i<3?'top3':''}">#${i+1}</span></td><td class="coin-name">${p.coin}</td><td><span class="direction ${p.direction.toLowerCase()}">${p.direction==='Long'?'ë¡±':'ìˆ'}</span></td><td>${fmt.usd(p.positionValue)}</td><td>${fmt.num(p.size)}</td><td>${fmt.px(p.entryPx, p.coin)}</td><td>${p.leverage}x</td><td class="${p.unrealizedPnl>=0?'positive':'negative'}">${fmt.usd(p.unrealizedPnl)}</td><td class="address"><a href="${getExplorerUrl(p.traderAddress)}" target="_blank">${p.traderName||fmt.addr(p.traderAddress)}</a></td></tr>`).join(''); }
        function getPosAgg() { const data = whaleData[currentWhaleDex]; if (!data?.positionAggregation) return []; if (posData === 'pnl') return posPeriod === 'daily' ? data.positionAggregation.byPnlDaily : data.positionAggregation.byPnlWeekly; return data.positionAggregation.bySize; }
        function renderPosChart() { const agg = getPosAgg(); if (!agg?.length) { document.getElementById('pos-chart').innerHTML = '<div class="no-data">ë°ì´í„° ì—†ìŒ</div>'; return; } const useVal = posUnit === 'value'; const max = Math.max(...agg.map(d => Math.max(useVal?d.long:d.longSize, useVal?d.short:d.shortSize))); document.getElementById('pos-chart').innerHTML = agg.map(d => { const lv = useVal?d.long:d.longSize, sv = useVal?d.short:d.shortSize; const lw = max>0?(lv/max)*100:0, sw = max>0?(sv/max)*100:0; return `<div class="bar-row"><div class="bar-label">${d.coin}</div><div class="bar-container"><div class="bar-negative"><div class="bar short" style="width:${sw}%">${sv>0?(useVal?fmt.usd(sv):fmt.num(sv)):''}</div></div><div class="bar-positive"><div class="bar long" style="width:${lw}%">${lv>0?(useVal?fmt.usd(lv):fmt.num(lv)):''}</div></div></div></div>`; }).join(''); }

        function togglePos(idx) { const row = document.getElementById(`pos-${idx}`); const btn = row?.previousElementSibling?.querySelector('.expand-btn'); if (row) { row.classList.toggle('show'); btn?.classList.toggle('expanded'); } }
        function openPositionModal(traderIdx, posIdx) { const data = whaleData[currentWhaleDex]; const traders = traderPeriod === 'daily' ? data?.whaleTracker?.daily : data?.whaleTracker?.weekly; if (!traders?.[traderIdx]?.positions?.[posIdx]) return; currentPosition = traders[traderIdx].positions[posIdx]; const p = currentPosition; document.getElementById('modal-coin').textContent = p.coin; const dirEl = document.getElementById('modal-direction'); dirEl.textContent = p.direction === 'Long' ? 'LONG' : 'SHORT'; dirEl.className = 'modal-direction ' + p.direction.toLowerCase(); document.getElementById('modal-size').textContent = fmt.usd(p.positionValue); document.getElementById('modal-entry').textContent = fmt.px(p.entryPx, p.coin); document.getElementById('modal-current').textContent = '-'; document.getElementById('modal-leverage').textContent = p.leverage + 'x'; document.getElementById('modal-pnl').textContent = fmt.usd(p.unrealizedPnl); document.getElementById('modal-pnl').className = 'modal-stat-value ' + (p.unrealizedPnl >= 0 ? 'positive' : 'negative'); document.getElementById('position-modal').classList.add('show'); loadPositionChart(); }
        function closePositionModal() { document.getElementById('position-modal').classList.remove('show'); currentPosition = null; if (positionChart) { positionChart.destroy(); positionChart = null; } }

        async function loadPositionChart() { if (!currentPosition) return; const loading = document.getElementById('modal-loading'); loading.style.display = 'flex'; try { const coin = currentPosition.coin; const entryPrice = currentPosition.entryPx; const symbol = coin + 'USDT'; const interval = currentTimeframe === '1D' ? '1d' : currentTimeframe; const response = await fetch(`https://api.binance.com/api/v3/klines?symbol=${symbol}&interval=${interval}&limit=100`); const data = await response.json(); if (data && data.length > 0) { const labels = data.map(d => { const date = new Date(d[0]); if (currentTimeframe === '1D') return date.toLocaleDateString('ko-KR', { month: 'short', day: 'numeric' }); return date.toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit' }); }); const prices = data.map(d => parseFloat(d[4])); const currentPrice = prices[prices.length - 1]; document.getElementById('modal-current').textContent = fmt.px(currentPrice, coin); if (positionChart) positionChart.destroy(); const ctx = document.getElementById('position-chart').getContext('2d'); positionChart = new Chart(ctx, { type: 'line', data: { labels: labels, datasets: [{ label: coin + ' Price', data: prices, borderColor: '#22d3ee', backgroundColor: 'rgba(34, 211, 238, 0.1)', borderWidth: 2, fill: true, tension: 0.1, pointRadius: 0, pointHoverRadius: 4 }] }, options: { responsive: true, maintainAspectRatio: false, interaction: { intersect: false, mode: 'index' }, plugins: { legend: { display: false }, tooltip: { callbacks: { label: ctx => fmt.px(ctx.raw, coin) } } }, scales: { x: { grid: { color: '#1a1a1a' }, ticks: { color: '#71717a', maxTicksLimit: 8 } }, y: { grid: { color: '#1a1a1a' }, ticks: { color: '#71717a', callback: v => fmt.px(v, coin) } } } }, plugins: [{ id: 'priceLines', afterDraw: function(chart) { const ctx = chart.ctx; const xAxis = chart.scales.x; const yAxis = chart.scales.y; const entryY = yAxis.getPixelForValue(entryPrice); if (entryY >= yAxis.top && entryY <= yAxis.bottom) { ctx.save(); ctx.beginPath(); ctx.setLineDash([5, 5]); ctx.strokeStyle = '#ef4444'; ctx.lineWidth = 2; ctx.moveTo(xAxis.left, entryY); ctx.lineTo(xAxis.right, entryY); ctx.stroke(); ctx.fillStyle = '#ef4444'; ctx.fillRect(xAxis.right - 80, entryY - 10, 80, 20); ctx.fillStyle = '#fff'; ctx.font = '10px JetBrains Mono'; ctx.textAlign = 'center'; ctx.fillText('Entry: ' + fmt.px(entryPrice, currentPosition.coin).replace('$',''), xAxis.right - 40, entryY + 4); ctx.restore(); } const currentY = yAxis.getPixelForValue(currentPrice); if (currentY >= yAxis.top && currentY <= yAxis.bottom) { ctx.save(); ctx.beginPath(); ctx.strokeStyle = '#22d3ee'; ctx.lineWidth = 2; ctx.moveTo(xAxis.left, currentY); ctx.lineTo(xAxis.right, currentY); ctx.stroke(); ctx.fillStyle = '#22d3ee'; ctx.fillRect(xAxis.right - 80, currentY - 10, 80, 20); ctx.fillStyle = '#000'; ctx.font = '10px JetBrains Mono'; ctx.textAlign = 'center'; ctx.fillText('Current: ' + fmt.px(currentPrice, currentPosition.coin).replace('$',''), xAxis.right - 40, currentY + 4); ctx.restore(); } } }] }); } } catch(e) { console.error('Chart error:', e); } loading.style.display = 'none'; }

        document.querySelectorAll('.tf-btn').forEach(btn => { btn.onclick = () => { document.querySelectorAll('.tf-btn').forEach(b => b.classList.remove('active')); btn.classList.add('active'); currentTimeframe = btn.dataset.tf; loadPositionChart(); }; });
        document.getElementById('position-modal').onclick = e => { if (e.target.id === 'position-modal') closePositionModal(); };
        document.querySelectorAll('.nav-item').forEach(n => n.onclick = () => { document.querySelectorAll('.nav-item').forEach(x => x.classList.remove('active')); document.querySelectorAll('.section').forEach(x => x.classList.remove('active')); n.classList.add('active'); document.getElementById(n.dataset.section).classList.add('active'); });
        document.querySelectorAll('.sub-tab').forEach(t => t.onclick = () => { document.querySelectorAll('.sub-tab').forEach(x => x.classList.remove('active')); t.classList.add('active'); document.getElementById('pnl-section').style.display = t.dataset.tab === 'pnl' ? 'block' : 'none'; document.getElementById('biggest-section').style.display = t.dataset.tab === 'biggest' ? 'block' : 'none'; });
        document.querySelectorAll('#trader-tabs .tab').forEach(t => t.onclick = () => { document.querySelectorAll('#trader-tabs .tab').forEach(x => x.classList.remove('active')); t.classList.add('active'); traderPeriod = t.dataset.v; renderPnL(); });
        document.querySelectorAll('#pos-data-tabs .tab').forEach(t => t.onclick = () => { document.querySelectorAll('#pos-data-tabs .tab').forEach(x => x.classList.remove('active')); t.classList.add('active'); posData = t.dataset.v; renderPosChart(); });
        document.querySelectorAll('#pos-period-tabs .tab').forEach(t => t.onclick = () => { document.querySelectorAll('#pos-period-tabs .tab').forEach(x => x.classList.remove('active')); t.classList.add('active'); posPeriod = t.dataset.v; renderPosChart(); });
        document.querySelectorAll('#pos-unit-tabs .tab').forEach(t => t.onclick = () => { document.querySelectorAll('#pos-unit-tabs .tab').forEach(x => x.classList.remove('active')); t.classList.add('active'); posUnit = t.dataset.v; renderPosChart(); });
        document.querySelectorAll('#live-tabs .tab').forEach(t => t.onclick = () => { document.querySelectorAll('#live-tabs .tab').forEach(x => x.classList.remove('active')); t.classList.add('active'); renderLive(); });
        document.querySelectorAll('#funding th.sortable').forEach(th => th.onclick = () => sortFunding(th.dataset.sort));
        document.getElementById('liq-coin').onchange = e => { selectedLiqCoin = e.target.value; updateLiqChart(); };

        // DEX Tab handlers
        document.querySelectorAll('#whale-dex-tabs .dex-tab').forEach(tab => { tab.onclick = () => { document.querySelectorAll('#whale-dex-tabs .dex-tab').forEach(t => t.classList.remove('active')); tab.classList.add('active'); currentWhaleDex = tab.dataset.dex; document.getElementById('pnl-tbody').innerHTML = '<tr><td colspan="7"><div class="loading"><div class="loading-spinner"></div>ë¡œë”© ì¤‘...</div></td></tr>'; document.getElementById('biggest-tbody').innerHTML = '<tr><td colspan="9"><div class="loading"><div class="loading-spinner"></div>ë¡œë”© ì¤‘...</div></td></tr>'; document.getElementById('pos-chart').innerHTML = '<div class="loading"><div class="loading-spinner"></div>ë¡œë”© ì¤‘...</div>'; if (!whaleData[currentWhaleDex]) { loadWhaleData(currentWhaleDex); } else { renderPnL(); renderBiggest(); renderPosChart(); updateWhaleLastUpdated(); } }; });
        document.querySelectorAll('#liq-dex-tabs .dex-tab').forEach(tab => { tab.onclick = () => { document.querySelectorAll('#liq-dex-tabs .dex-tab').forEach(t => t.classList.remove('active')); tab.classList.add('active'); currentLiqDex = tab.dataset.dex; if (!liqData[currentLiqDex]) { loadLiqData(currentLiqDex); } else { populateLiqCoins(); updateLiqLastUpdated(); } }; });

        async function init() { await Promise.all([loadWhaleData('hyperliquid'), loadLiqData('hyperliquid')]); fetchLive(); }
        setInterval(fetchLive, 30000);
        init();
    </script>
</body>
</html>
